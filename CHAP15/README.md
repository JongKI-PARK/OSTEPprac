
# Notice

Source code `relocation.py` is from https://github.com/remzi-arpacidusseau/ostep-homework/tree/master/vm-mechanism.  
See more details about this program in https://github.com/remzi-arpacidusseau/ostep-homework/blob/master/vm-mechanism/README.md.  

  ```
  $ python3 relocation.py --help
  Usage: relocation.py [options]

  Options:
    -h, --help            show this help message and exit
    -s SEED, --seed=SEED  the random seed
    -a ASIZE, --asize=ASIZE
                          address space size (e.g., 16, 64k, 32m, 1g)
    -p PSIZE, --physmem=PSIZE
                          physical memory size (e.g., 16, 64k, 32m, 1g)
    -n NUM, --addresses=NUM
                          number of virtual addresses to generate
    -b BASE, --b=BASE     value of base register
    -l LIMIT, --l=LIMIT   value of limit register
    -c, --compute         compute answers for me
    
   ```

# Homework

**1. Run with seeds 1, 2, and 3, and compute whether each virtual address generated by the process is in or out of bounds. If in bounds, compute the translation.**

  ```
  $ python3 relocation.py --seed=1
  ARG seed 1
  ARG address space size 1k
  ARG phys mem size 16k

  Base-and-Bounds register information:

    Base   : 0x0000363c (decimal 13884)
    Limit  : 290

  Virtual Address Trace
    VA  0: 0x0000030e (decimal:  782) --> PA or segmentation violation?
    VA  1: 0x00000105 (decimal:  261) --> PA or segmentation violation?
    VA  2: 0x000001fb (decimal:  507) --> PA or segmentation violation?
    VA  3: 0x000001cc (decimal:  460) --> PA or segmentation violation?
    VA  4: 0x0000029b (decimal:  667) --> PA or segmentation violation?

  For each virtual address, either write down the physical address it translates to
  OR write down that it is an out-of-bounds address (a segmentation violation). For
  this problem, you should assume a simple virtual address space of a given size.
  ```
  VA 0 : Invalid  
  VA 1 : VALID (Physical address : bound + offset = 0x0000363c + 0x00000105 = 0x00003741)  
  VA 2 : Invalid  
  VA 3 : Invalid  
  VA 4 : Invalid   
  
  ```
  $ python3 relocation.py --seed=2

  ARG seed 2
  ARG address space size 1k
  ARG phys mem size 16k

  Base-and-Bounds register information:

    Base   : 0x00003ca9 (decimal 15529)
    Limit  : 500

  Virtual Address Trace
    VA  0: 0x00000039 (decimal:   57) --> PA or segmentation violation?
    VA  1: 0x00000056 (decimal:   86) --> PA or segmentation violation?
    VA  2: 0x00000357 (decimal:  855) --> PA or segmentation violation?
    VA  3: 0x000002f1 (decimal:  753) --> PA or segmentation violation?
    VA  4: 0x000002ad (decimal:  685) --> PA or segmentation violation?
  ```
  
  VA 0 : Valid (Physical address : 0x00003ca9 + 0x00000039 = 0x00003ce2)  
  VA 1 : Valid (Physical address : 0x00003ca9 + 0x00000056 = 0x00003cff)  
  VA 2 : Invalid  
  VA 3 : Invalid  
  VA 4 : Invalid  

  ```
  $ python3 relocation.py -s 3

  ARG seed 3
  ARG address space size 1k
  ARG phys mem size 16k

  Base-and-Bounds register information:

    Base   : 0x000022d4 (decimal 8916)
    Limit  : 316

  Virtual Address Trace
    VA  0: 0x0000017a (decimal:  378) --> PA or segmentation violation?
    VA  1: 0x0000026a (decimal:  618) --> PA or segmentation violation?
    VA  2: 0x00000280 (decimal:  640) --> PA or segmentation violation?
    VA  3: 0x00000043 (decimal:   67) --> PA or segmentation violation?
    VA  4: 0x0000000d (decimal:   13) --> PA or segmentation violation?
  ```
  VA 0 :  
  VA 1 :   
  VA 2 :  
  VA 3 :  
  VA 4 :  

<br><br><br>

**2. Run with these flags: `-s 0 -n 10`. What value do you have set -l (the bounds register) to in order to ensure that all the generated virtual addresses are within bounds?**

A : The result with -s 0 -n 10 flags 
  ``` 
  ARG seed 0
  ARG address space size 1k
  ARG phys mem size 16k

  Base-and-Bounds register information:

    Base   : 0x00003082 (decimal 12418)
    Limit  : 472

  Virtual Address Trace
    VA  0: 0x000001ae (decimal:  430) --> VALID: 0x00003230 (decimal: 12848)
    VA  1: 0x00000109 (decimal:  265) --> VALID: 0x0000318b (decimal: 12683)
    VA  2: 0x0000020b (decimal:  523) --> SEGMENTATION VIOLATION
    VA  3: 0x0000019e (decimal:  414) --> VALID: 0x00003220 (decimal: 12832)
    VA  4: 0x00000322 (decimal:  802) --> SEGMENTATION VIOLATION
    VA  5: 0x00000136 (decimal:  310) --> VALID: 0x000031b8 (decimal: 12728)
    VA  6: 0x000001e8 (decimal:  488) --> SEGMENTATION VIOLATION
    VA  7: 0x00000255 (decimal:  597) --> SEGMENTATION VIOLATION
    VA  8: 0x000003a1 (decimal:  929) --> SEGMENTATION VIOLATION
    VA  9: 0x00000204 (decimal:  516) --> SEGMENTATION VIOLATION
  ```

If all these virtual addresses to be valid, the value for the flag -l needs to be bigger than the maximum offset 929.

<br><br><br>

**3. Run with these flags: -s 1 -n 10 -l 100. What is the maximum value that base can be set to, such that the address space still fits into physical memory in its entirety?**

<br><br><br>

**4. Run some of the same problems above, but with larger address spaces (-a) and physical memories (-p).**

<br><br><br>

**5. What fraction of randomly-generated virtual addresses are valid, as a function of the value of the bounds register? Make a graph from running with different random seeds, with limit values ranging from 0 up to the maximum size of the address space.**
